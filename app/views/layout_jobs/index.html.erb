<div class="pull-right">
  <%= link_to 'New Layout job', new_layout_job_path, :class => "btn btn-primary"%>
</div>

<% content_for :script do %>
  <script>
    $(document).ready(function() {
      $('.edit').editable('<%= "#{receive_edit_layout_jobs_url.to_s}" %>')
    });
  </script>
  <script>
    $(document).ready(function() {
      $('.edit_area').editable('<%= "#{receive_edit_layout_jobs_url.to_s}" %>', {
        type      : 'textarea',
        submit    : 'OK',
        tooltip   : 'Click to edit...',
        height    : "75px",
      });
    });
  </script>
  <script>
    $(document).ready(function() {
      $('.editable').editable('<%= "#{receive_edit_layout_jobs_url.to_s}" %>', {
        data   : " {'854':'Steinar','884':'Henrikke','G':'Letter G', 'selected':'854'}",
        type   : 'select',
        submit : 'OK',
      });
    });
  </script>
<% end %>


<h1>Your Layout jobs</h1>
<div class="container-fluid">
  <table class="table table-bordered table-condensed sortable">
    <thead>
      <th class="span1">Status</th>
      <th class="span1">Deadline</th>
      <th class="span1">Owner</th>
      <th class="span1">Title</th>
      <th class="span1">Nr</th>
      <th class="span3">Description</th>
      <th class="span1">Group</th>
      <th class="span1">Contact</th>
    </thead>

    <% @layout_jobs.each do |layout_job| %>

    <!--%= "#{User.joins(:groups).where('groups.id = 98').collect {|u| {u.id => u.given_name + ' ' + u.family_name}}.to_json}" %-->

    <tr>
      <td class=<%= layout_job.status_color %>><%= layout_job.status_name %></td>
      <td><%= layout_job.deadline %></td>
      <td style="background-color: <%= layout_job.color %>"><div class="editable" id="<%= layout_job.id %>"><%= layout_job.owner %></div></td>
      <td><%= link_to layout_job.work_title, layout_job %></td>
      <td><%= layout_job.number %></td>
      <td><div class="edit_area layout-jobs-description"><%= simple_format truncate(layout_job.description, length: 400, omission: "...") %></div></td>
      <td><%= layout_job.group.name_en %></td>
      <td><%= link_to User.find(layout_job.user_id).full_name ,user_path(layout_job.user_id) %></td>
    </tr>
    <% end %>
  </table>
</div>
